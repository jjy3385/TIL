# 10강.쓰레드,프로세스 동기화

## 쓰레드(Thread)

* 프로그램 내부의 흐름,맥

### 다중 쓰레드(Multi Thread)

* 한 프로그램에 2개 이상의 맥
* 맥이 빠른 간격으로 스위칭되기 때문에 여러 맥이 동시에 실행되는 것처럼 느껴진다
* 일반적으로 concurrent 하다고 할 수 있음
* simultaneous 는 진짜 동시에 실행되는 것임

### 쓰레드 구조

* 프로세스의 메모리 공간 공유(code,data)
* 프로세스의 자원 공유(file, I/O)
* 🎯그러나 PC,SP,registers,**stack** 은 공유하지 않음

> 💡컴퓨터 구조에서 배울 수 있는 내용, 간단정리 필요
>
> * PC(Program counter) 
>   * 다음에 실행될 명령어의 주소를 가지고 있는 프로세스 내부의 레지스터
>   * 명령어 포인터라고도 함
> * SP(Stack pointer)
>   * 스택의 데이터가 채워진 마지막 위치를 가리킴
> * STACK 
>   * 후입선출의 특성을 가진 자료구조이며 레지스터의 데이터를 임시로 저장하기에 적합
>
> 🎯추후 스터디 필요

* 아무튼 쓰레드마다 별도의 PC,SP,stack 을 두어야 스위칭 될 때마다 이전 상태를 기억하고 복원(restore) 할 수 있음


* 프로세스의 스위칭 VS 쓰레드의 스위칭

  * 60~70년대는 프로세스 단위의 스위칭이였지만 현재의 운영체제는 모두 쓰레드 단위이다

  ​

## 멀티 쓰레드(프로세스) 환경과 동기화

> 예를 들어, 1원을 100번 입금하는 쓰레드와 1월을 100번 출금하는 쓰레드가 동시에 수행되면 정상적으로 수행됐다고 하면 최초금액이 변하지 않아야 하지만 실제로는 그렇지 않은 경우가 있을 수 있음
> 🎯**왜냐하면 금액 변수에 값을 적용하는 한줄의 코드가 사실은 기계어 수준에서 하나의 명령이 아니고 컨택스트 스위칭이 그 명령 사이에 일어날 수 있기 때문임**
>
> 따라서 이에 대한 제어가 필요





